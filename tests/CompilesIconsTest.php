<?php

declare(strict_types=1);

namespace Tests;

use MatthewHallCom\BladeMlsIcons\BladeMlsIconsServiceProvider;
use BladeUI\Icons\BladeIconsServiceProvider;
use Orchestra\Testbench\TestCase;

class CompilesIconsTest extends TestCase
{
    /** @test */
    public function it_compiles_a_single_anonymous_component()
    {
        $result = svg('mls-vancouver-whitecaps-fc')->toHtml();

        // Note: the empty class here seems to be a Blade components bug.
        $expected = <<<'SVG'
            <svg xmlns="http://www.w3.org/2000/svg" width="277.664" height="360.147" viewBox="0 0 361.417 468.78"><defs><clipPath id="a"><path d="M690.378 501.667h79.121v79.121h-79.121z"/></clipPath></defs><path d="m347.326 514.479-.854 1.429-6.356 10.635-2.674-4.472-.852-1.428-.855 1.428-20.407 34.148-.305.51.305.51 20.117 33.661.853 1.429.854-1.429 2.766-4.629 6.553 10.963.854 1.429.853-1.43 6.553-10.963 2.769 4.633.853 1.426.854-1.426 20.116-33.664.307-.51-.307-.51-20.408-34.146-.853-1.43-.855 1.43-2.672 4.47-6.355-10.635zm0 1.939 7.209 12.062 3.527-5.897 20.408 34.146-20.118 33.662-3.621-6.058-7.406 12.39-7.407-12.39-3.62 6.057-20.116-33.661 20.408-34.148 3.526 5.9z" style="fill:#aeacad;fill-opacity:1;fill-rule:nonzero;stroke:none" transform="matrix(5.48446 0 0 5.48446 -1724.19 -2818.103)"/><path d="m339.918 584.333 7.407 12.391 7.406-12.391 3.621 6.059 20.118-33.663-20.41-34.147-3.525 5.897-7.21-12.062-7.21 12.063-3.525-5.898-20.408 34.147 20.116 33.661z" style="fill:#00245e;fill-opacity:1;fill-rule:nonzero;stroke:none" transform="matrix(5.48446 0 0 5.48446 -1724.19 -2818.103)"/><path d="m360.717 562.52-13.39 22.402-13.391-22.401h-4.526l17.917 29.975 17.914-29.975zM336.3 578.593l-9.604-16.071h-4.525l14.129 23.641 3.147-5.264-2.264-3.785zm31.66-16.071-9.607 16.071-.881-1.479-2.264 3.785 3.145 5.265 14.132-23.642z" style="fill:#9dc2ea;fill-opacity:1;fill-rule:nonzero;stroke:none" transform="matrix(5.48446 0 0 5.48446 -1724.19 -2818.103)"/><path d="m358.062 526.811-3.064 5.124 2.204 3.686.86-1.439 10.012 16.754h4.406zm-35.89 24.125h4.406l10.014-16.754.86 1.438 2.203-3.684-3.063-5.125zM336.865 545.522l10.463-17.504 10.461 17.504h4.406l-14.867-24.876-14.869 24.876zM320.022 553.518h1.537l1.024 4.107h.016l1.34-4.107h1.313l1.33 4.216h.017l1.076-4.216h1.43l-1.872 6.406h-1.258l-1.41-4.435h-.02l-1.41 4.435h-1.213zM329.787 553.518h1.41v2.388h2.743v-2.388h1.412v6.406h-1.412v-2.769h-2.742v2.769h-1.411zM336.89 553.517h1.41v6.407h-1.41zM341.18 554.766h-1.828v-1.248h5.068v1.248h-1.829v5.157h-1.411zM345.521 553.518h4.354v1.303h-2.941v1.194h2.174v1.303h-2.174v1.304h3.104v1.302h-4.517z" style="fill:#fff;fill-opacity:1;fill-rule:nonzero;stroke:none" transform="matrix(5.48446 0 0 5.48446 -1724.19 -2818.103)"/><g clip-path="url(#a)" transform="matrix(6.85558 0 0 -6.85558 -4823.072 3944.125)"><path d="M736.157 542.238c-.224.267-.55.419-.97.419-.853 0-1.484-.695-1.484-1.65 0-.956.63-1.65 1.448-1.65.456 0 .825.202 1.057.549l.94-.702c-.427-.608-1.15-.89-1.852-.89-1.601 0-2.765 1.049-2.765 2.693 0 1.643 1.164 2.692 2.765 2.692.572 0 1.295-.196 1.73-.753zM739.906 542.078l-.622-1.592h1.252zm-.434 1.49h.934l2.23-5.124h-1.275l-.44 1.086h-1.992l-.427-1.086h-1.245zM744.273 541.397h.754c.397 0 .796.138.796.615 0 .53-.536.601-.971.601h-.58zm-1.128 2.171h1.903c1.065 0 1.947-.34 1.947-1.556 0-1.2-.817-1.57-1.896-1.57h-.826v-1.998h-1.128zM750.382 542.317c-.18.23-.544.34-.819.34-.318 0-.759-.145-.759-.53 0-.932 2.36-.331 2.36-2.127 0-1.144-.92-1.686-1.977-1.686-.659 0-1.238.195-1.723.644l.804.883c.231-.303.607-.485.984-.485.37 0 .782.174.782.535 0 .942-2.404.435-2.404 2.143 0 1.093.95 1.665 1.955 1.665.58 0 1.137-.152 1.571-.535zM725.737 536.394h3.437v-1.043h-2.308v-1.042h1.652v-1.042h-1.652v-1.998h-1.129zM732.975 535.063c-.224.267-.549.419-.97.419-.854 0-1.484-.695-1.484-1.65s.63-1.65 1.448-1.65c.457 0 .825.203 1.057.55l.941-.702c-.427-.608-1.15-.891-1.853-.891-1.6 0-2.765 1.05-2.765 2.693s1.165 2.693 2.765 2.693c.572 0 1.296-.196 1.73-.753zM716.748 548.545h.736l.724-1.919h.008l.737 1.919h.69l-1.207-2.928h-.517zM720.712 547.693l-.356-.91h.716zm-.248.852h.534l1.273-2.929h-.727l-.253.621h-1.138l-.243-.62h-.71zM722.624 548.545h.877l1.245-2.035h.009v2.035h.645v-2.928h-.844l-1.28 2.084h-.008v-2.084h-.645zM727.944 547.784a.7.7 0 0 1-.554.24c-.488 0-.848-.397-.848-.943s.36-.943.827-.943a.7.7 0 0 1 .604.314l.538-.401c-.244-.347-.66-.51-1.06-.51-.913 0-1.58.6-1.58 1.54 0 .939.667 1.538 1.58 1.538.327 0 .74-.112.989-.43zM730.297 546.138c.55 0 .91.397.91.943s-.36.943-.91.943-.91-.397-.91-.943.36-.943.91-.943m0 2.482c.914 0 1.58-.6 1.58-1.54 0-.939-.666-1.538-1.58-1.538-.915 0-1.58.6-1.58 1.538 0 .94.665 1.54 1.58 1.54M734.892 546.746c0-.691-.422-1.203-1.233-1.203-.815 0-1.237.512-1.237 1.203v1.799h.646v-1.774c0-.36.248-.633.591-.633.34 0 .587.273.587.633v1.774h.646zM735.248 548.545h.737l.724-1.919h.008l.737 1.919h.69l-1.207-2.928h-.517zM738.534 548.545h1.99v-.596h-1.345v-.546h1.27v-.595h-1.27v-.596h1.418v-.595h-2.063zM741.817 547.333h.38c.236 0 .542.008.542.326 0 .295-.265.34-.5.34h-.422zm-.645 1.212h1.133c.6 0 1.104-.207 1.104-.89 0-.409-.22-.727-.633-.803l.745-1.236h-.773l-.612 1.171h-.32v-1.17h-.644z" style="fill:#fff;fill-opacity:1;fill-rule:nonzero;stroke:none"/><path d="M741.295 515.22h.438v-1.15h.225v1.15h.441v.2h-1.104zM743.223 514.341l-.342 1.08h-.33v-1.351h.206v1.15l.363-1.15h.205l.347 1.133v-1.133h.206v1.351h-.325z" style="fill:#051c36;fill-opacity:1;fill-rule:nonzero;stroke:none"/></g></svg>
            SVG;

        $this->assertSame($expected, $result);
    }

    /** @test */
    public function it_can_add_classes_to_icons()
    {
        $result = svg('mls-vancouver-whitecaps-fc', 'w-6 h-6 text-gray-500')->toHtml();

        $expected = <<<'SVG'
            <svg class="w-6 h-6 text-gray-500" xmlns="http://www.w3.org/2000/svg" width="277.664" height="360.147" viewBox="0 0 361.417 468.78"><defs><clipPath id="a"><path d="M690.378 501.667h79.121v79.121h-79.121z"/></clipPath></defs><path d="m347.326 514.479-.854 1.429-6.356 10.635-2.674-4.472-.852-1.428-.855 1.428-20.407 34.148-.305.51.305.51 20.117 33.661.853 1.429.854-1.429 2.766-4.629 6.553 10.963.854 1.429.853-1.43 6.553-10.963 2.769 4.633.853 1.426.854-1.426 20.116-33.664.307-.51-.307-.51-20.408-34.146-.853-1.43-.855 1.43-2.672 4.47-6.355-10.635zm0 1.939 7.209 12.062 3.527-5.897 20.408 34.146-20.118 33.662-3.621-6.058-7.406 12.39-7.407-12.39-3.62 6.057-20.116-33.661 20.408-34.148 3.526 5.9z" style="fill:#aeacad;fill-opacity:1;fill-rule:nonzero;stroke:none" transform="matrix(5.48446 0 0 5.48446 -1724.19 -2818.103)"/><path d="m339.918 584.333 7.407 12.391 7.406-12.391 3.621 6.059 20.118-33.663-20.41-34.147-3.525 5.897-7.21-12.062-7.21 12.063-3.525-5.898-20.408 34.147 20.116 33.661z" style="fill:#00245e;fill-opacity:1;fill-rule:nonzero;stroke:none" transform="matrix(5.48446 0 0 5.48446 -1724.19 -2818.103)"/><path d="m360.717 562.52-13.39 22.402-13.391-22.401h-4.526l17.917 29.975 17.914-29.975zM336.3 578.593l-9.604-16.071h-4.525l14.129 23.641 3.147-5.264-2.264-3.785zm31.66-16.071-9.607 16.071-.881-1.479-2.264 3.785 3.145 5.265 14.132-23.642z" style="fill:#9dc2ea;fill-opacity:1;fill-rule:nonzero;stroke:none" transform="matrix(5.48446 0 0 5.48446 -1724.19 -2818.103)"/><path d="m358.062 526.811-3.064 5.124 2.204 3.686.86-1.439 10.012 16.754h4.406zm-35.89 24.125h4.406l10.014-16.754.86 1.438 2.203-3.684-3.063-5.125zM336.865 545.522l10.463-17.504 10.461 17.504h4.406l-14.867-24.876-14.869 24.876zM320.022 553.518h1.537l1.024 4.107h.016l1.34-4.107h1.313l1.33 4.216h.017l1.076-4.216h1.43l-1.872 6.406h-1.258l-1.41-4.435h-.02l-1.41 4.435h-1.213zM329.787 553.518h1.41v2.388h2.743v-2.388h1.412v6.406h-1.412v-2.769h-2.742v2.769h-1.411zM336.89 553.517h1.41v6.407h-1.41zM341.18 554.766h-1.828v-1.248h5.068v1.248h-1.829v5.157h-1.411zM345.521 553.518h4.354v1.303h-2.941v1.194h2.174v1.303h-2.174v1.304h3.104v1.302h-4.517z" style="fill:#fff;fill-opacity:1;fill-rule:nonzero;stroke:none" transform="matrix(5.48446 0 0 5.48446 -1724.19 -2818.103)"/><g clip-path="url(#a)" transform="matrix(6.85558 0 0 -6.85558 -4823.072 3944.125)"><path d="M736.157 542.238c-.224.267-.55.419-.97.419-.853 0-1.484-.695-1.484-1.65 0-.956.63-1.65 1.448-1.65.456 0 .825.202 1.057.549l.94-.702c-.427-.608-1.15-.89-1.852-.89-1.601 0-2.765 1.049-2.765 2.693 0 1.643 1.164 2.692 2.765 2.692.572 0 1.295-.196 1.73-.753zM739.906 542.078l-.622-1.592h1.252zm-.434 1.49h.934l2.23-5.124h-1.275l-.44 1.086h-1.992l-.427-1.086h-1.245zM744.273 541.397h.754c.397 0 .796.138.796.615 0 .53-.536.601-.971.601h-.58zm-1.128 2.171h1.903c1.065 0 1.947-.34 1.947-1.556 0-1.2-.817-1.57-1.896-1.57h-.826v-1.998h-1.128zM750.382 542.317c-.18.23-.544.34-.819.34-.318 0-.759-.145-.759-.53 0-.932 2.36-.331 2.36-2.127 0-1.144-.92-1.686-1.977-1.686-.659 0-1.238.195-1.723.644l.804.883c.231-.303.607-.485.984-.485.37 0 .782.174.782.535 0 .942-2.404.435-2.404 2.143 0 1.093.95 1.665 1.955 1.665.58 0 1.137-.152 1.571-.535zM725.737 536.394h3.437v-1.043h-2.308v-1.042h1.652v-1.042h-1.652v-1.998h-1.129zM732.975 535.063c-.224.267-.549.419-.97.419-.854 0-1.484-.695-1.484-1.65s.63-1.65 1.448-1.65c.457 0 .825.203 1.057.55l.941-.702c-.427-.608-1.15-.891-1.853-.891-1.6 0-2.765 1.05-2.765 2.693s1.165 2.693 2.765 2.693c.572 0 1.296-.196 1.73-.753zM716.748 548.545h.736l.724-1.919h.008l.737 1.919h.69l-1.207-2.928h-.517zM720.712 547.693l-.356-.91h.716zm-.248.852h.534l1.273-2.929h-.727l-.253.621h-1.138l-.243-.62h-.71zM722.624 548.545h.877l1.245-2.035h.009v2.035h.645v-2.928h-.844l-1.28 2.084h-.008v-2.084h-.645zM727.944 547.784a.7.7 0 0 1-.554.24c-.488 0-.848-.397-.848-.943s.36-.943.827-.943a.7.7 0 0 1 .604.314l.538-.401c-.244-.347-.66-.51-1.06-.51-.913 0-1.58.6-1.58 1.54 0 .939.667 1.538 1.58 1.538.327 0 .74-.112.989-.43zM730.297 546.138c.55 0 .91.397.91.943s-.36.943-.91.943-.91-.397-.91-.943.36-.943.91-.943m0 2.482c.914 0 1.58-.6 1.58-1.54 0-.939-.666-1.538-1.58-1.538-.915 0-1.58.6-1.58 1.538 0 .94.665 1.54 1.58 1.54M734.892 546.746c0-.691-.422-1.203-1.233-1.203-.815 0-1.237.512-1.237 1.203v1.799h.646v-1.774c0-.36.248-.633.591-.633.34 0 .587.273.587.633v1.774h.646zM735.248 548.545h.737l.724-1.919h.008l.737 1.919h.69l-1.207-2.928h-.517zM738.534 548.545h1.99v-.596h-1.345v-.546h1.27v-.595h-1.27v-.596h1.418v-.595h-2.063zM741.817 547.333h.38c.236 0 .542.008.542.326 0 .295-.265.34-.5.34h-.422zm-.645 1.212h1.133c.6 0 1.104-.207 1.104-.89 0-.409-.22-.727-.633-.803l.745-1.236h-.773l-.612 1.171h-.32v-1.17h-.644z" style="fill:#fff;fill-opacity:1;fill-rule:nonzero;stroke:none"/><path d="M741.295 515.22h.438v-1.15h.225v1.15h.441v.2h-1.104zM743.223 514.341l-.342 1.08h-.33v-1.351h.206v1.15l.363-1.15h.205l.347 1.133v-1.133h.206v1.351h-.325z" style="fill:#051c36;fill-opacity:1;fill-rule:nonzero;stroke:none"/></g></svg>
            SVG;

        $this->assertSame($expected, $result);
    }

    /** @test */
    public function it_can_add_styles_to_icons()
    {
        $result = svg('mls-vancouver-whitecaps-fc', ['style' => 'color: #555'])->toHtml();

        $expected = <<<'SVG'
            <svg style="color: #555" xmlns="http://www.w3.org/2000/svg" width="277.664" height="360.147" viewBox="0 0 361.417 468.78"><defs><clipPath id="a"><path d="M690.378 501.667h79.121v79.121h-79.121z"/></clipPath></defs><path d="m347.326 514.479-.854 1.429-6.356 10.635-2.674-4.472-.852-1.428-.855 1.428-20.407 34.148-.305.51.305.51 20.117 33.661.853 1.429.854-1.429 2.766-4.629 6.553 10.963.854 1.429.853-1.43 6.553-10.963 2.769 4.633.853 1.426.854-1.426 20.116-33.664.307-.51-.307-.51-20.408-34.146-.853-1.43-.855 1.43-2.672 4.47-6.355-10.635zm0 1.939 7.209 12.062 3.527-5.897 20.408 34.146-20.118 33.662-3.621-6.058-7.406 12.39-7.407-12.39-3.62 6.057-20.116-33.661 20.408-34.148 3.526 5.9z" style="fill:#aeacad;fill-opacity:1;fill-rule:nonzero;stroke:none" transform="matrix(5.48446 0 0 5.48446 -1724.19 -2818.103)"/><path d="m339.918 584.333 7.407 12.391 7.406-12.391 3.621 6.059 20.118-33.663-20.41-34.147-3.525 5.897-7.21-12.062-7.21 12.063-3.525-5.898-20.408 34.147 20.116 33.661z" style="fill:#00245e;fill-opacity:1;fill-rule:nonzero;stroke:none" transform="matrix(5.48446 0 0 5.48446 -1724.19 -2818.103)"/><path d="m360.717 562.52-13.39 22.402-13.391-22.401h-4.526l17.917 29.975 17.914-29.975zM336.3 578.593l-9.604-16.071h-4.525l14.129 23.641 3.147-5.264-2.264-3.785zm31.66-16.071-9.607 16.071-.881-1.479-2.264 3.785 3.145 5.265 14.132-23.642z" style="fill:#9dc2ea;fill-opacity:1;fill-rule:nonzero;stroke:none" transform="matrix(5.48446 0 0 5.48446 -1724.19 -2818.103)"/><path d="m358.062 526.811-3.064 5.124 2.204 3.686.86-1.439 10.012 16.754h4.406zm-35.89 24.125h4.406l10.014-16.754.86 1.438 2.203-3.684-3.063-5.125zM336.865 545.522l10.463-17.504 10.461 17.504h4.406l-14.867-24.876-14.869 24.876zM320.022 553.518h1.537l1.024 4.107h.016l1.34-4.107h1.313l1.33 4.216h.017l1.076-4.216h1.43l-1.872 6.406h-1.258l-1.41-4.435h-.02l-1.41 4.435h-1.213zM329.787 553.518h1.41v2.388h2.743v-2.388h1.412v6.406h-1.412v-2.769h-2.742v2.769h-1.411zM336.89 553.517h1.41v6.407h-1.41zM341.18 554.766h-1.828v-1.248h5.068v1.248h-1.829v5.157h-1.411zM345.521 553.518h4.354v1.303h-2.941v1.194h2.174v1.303h-2.174v1.304h3.104v1.302h-4.517z" style="fill:#fff;fill-opacity:1;fill-rule:nonzero;stroke:none" transform="matrix(5.48446 0 0 5.48446 -1724.19 -2818.103)"/><g clip-path="url(#a)" transform="matrix(6.85558 0 0 -6.85558 -4823.072 3944.125)"><path d="M736.157 542.238c-.224.267-.55.419-.97.419-.853 0-1.484-.695-1.484-1.65 0-.956.63-1.65 1.448-1.65.456 0 .825.202 1.057.549l.94-.702c-.427-.608-1.15-.89-1.852-.89-1.601 0-2.765 1.049-2.765 2.693 0 1.643 1.164 2.692 2.765 2.692.572 0 1.295-.196 1.73-.753zM739.906 542.078l-.622-1.592h1.252zm-.434 1.49h.934l2.23-5.124h-1.275l-.44 1.086h-1.992l-.427-1.086h-1.245zM744.273 541.397h.754c.397 0 .796.138.796.615 0 .53-.536.601-.971.601h-.58zm-1.128 2.171h1.903c1.065 0 1.947-.34 1.947-1.556 0-1.2-.817-1.57-1.896-1.57h-.826v-1.998h-1.128zM750.382 542.317c-.18.23-.544.34-.819.34-.318 0-.759-.145-.759-.53 0-.932 2.36-.331 2.36-2.127 0-1.144-.92-1.686-1.977-1.686-.659 0-1.238.195-1.723.644l.804.883c.231-.303.607-.485.984-.485.37 0 .782.174.782.535 0 .942-2.404.435-2.404 2.143 0 1.093.95 1.665 1.955 1.665.58 0 1.137-.152 1.571-.535zM725.737 536.394h3.437v-1.043h-2.308v-1.042h1.652v-1.042h-1.652v-1.998h-1.129zM732.975 535.063c-.224.267-.549.419-.97.419-.854 0-1.484-.695-1.484-1.65s.63-1.65 1.448-1.65c.457 0 .825.203 1.057.55l.941-.702c-.427-.608-1.15-.891-1.853-.891-1.6 0-2.765 1.05-2.765 2.693s1.165 2.693 2.765 2.693c.572 0 1.296-.196 1.73-.753zM716.748 548.545h.736l.724-1.919h.008l.737 1.919h.69l-1.207-2.928h-.517zM720.712 547.693l-.356-.91h.716zm-.248.852h.534l1.273-2.929h-.727l-.253.621h-1.138l-.243-.62h-.71zM722.624 548.545h.877l1.245-2.035h.009v2.035h.645v-2.928h-.844l-1.28 2.084h-.008v-2.084h-.645zM727.944 547.784a.7.7 0 0 1-.554.24c-.488 0-.848-.397-.848-.943s.36-.943.827-.943a.7.7 0 0 1 .604.314l.538-.401c-.244-.347-.66-.51-1.06-.51-.913 0-1.58.6-1.58 1.54 0 .939.667 1.538 1.58 1.538.327 0 .74-.112.989-.43zM730.297 546.138c.55 0 .91.397.91.943s-.36.943-.91.943-.91-.397-.91-.943.36-.943.91-.943m0 2.482c.914 0 1.58-.6 1.58-1.54 0-.939-.666-1.538-1.58-1.538-.915 0-1.58.6-1.58 1.538 0 .94.665 1.54 1.58 1.54M734.892 546.746c0-.691-.422-1.203-1.233-1.203-.815 0-1.237.512-1.237 1.203v1.799h.646v-1.774c0-.36.248-.633.591-.633.34 0 .587.273.587.633v1.774h.646zM735.248 548.545h.737l.724-1.919h.008l.737 1.919h.69l-1.207-2.928h-.517zM738.534 548.545h1.99v-.596h-1.345v-.546h1.27v-.595h-1.27v-.596h1.418v-.595h-2.063zM741.817 547.333h.38c.236 0 .542.008.542.326 0 .295-.265.34-.5.34h-.422zm-.645 1.212h1.133c.6 0 1.104-.207 1.104-.89 0-.409-.22-.727-.633-.803l.745-1.236h-.773l-.612 1.171h-.32v-1.17h-.644z" style="fill:#fff;fill-opacity:1;fill-rule:nonzero;stroke:none"/><path d="M741.295 515.22h.438v-1.15h.225v1.15h.441v.2h-1.104zM743.223 514.341l-.342 1.08h-.33v-1.351h.206v1.15l.363-1.15h.205l.347 1.133v-1.133h.206v1.351h-.325z" style="fill:#051c36;fill-opacity:1;fill-rule:nonzero;stroke:none"/></g></svg>
            SVG;
        $this->assertSame($expected, $result);
    }

    protected function getPackageProviders($app)
    {
        return [
            BladeIconsServiceProvider::class,
            BladeMlsIconsServiceProvider::class,
        ];
    }
}
